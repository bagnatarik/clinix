<app-data-table-component
  newButtonLabel="Ajouter un antécédant"
  tableName="Antécédants"
  [columns]="columns"
  [data]="antecedants"
  [searchable]="true"
  [paginated]="true"
  [itemsPerPage]="10"
  (onNew)="handleNew()"
  (onRefresh)="handleRefresh()"
  (onEdit)="handleEdit($event)"
  (onDelete)="handleDelete($event)"
  (onRowClick)="handleRowClick($event)"
>
</app-data-table-component>

@if (showCreateModal) {
<div class="fixed inset-0 bg-black/10 flex items-center justify-center z-50" (click)="showCreateModal = false">
  <div class="bg-white rounded p-5 w-[560px] shadow-md" (click)="$event.stopPropagation()">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-lg font-medium text-gray-800">Ajouter un antécédant</h2>
      <button (click)="showCreateModal = false" class="text-gray-400 hover:text-gray-600 hover:cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-4">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-xs font-medium text-gray-600 mb-1">ID</label>
        <input type="text" [(ngModel)]="antecedantForm.id" class="w-full px-3 py-1.5 border border-gray-200 rounded focus:border-blue-500 focus:outline-none text-sm" />
      </div>
      <div class="col-span-2">
        <label class="block text-xs font-medium text-gray-600 mb-1">Description</label>
        <textarea [(ngModel)]="antecedantForm.description" rows="3" class="w-full px-3 py-1.5 border border-gray-200 rounded focus:border-blue-500 focus:outline-none text-sm"></textarea>
      </div>
      <div>
        <label class="block text-xs font-medium text-gray-600 mb-1">Type d’antécédant</label>
        <select [(ngModel)]="antecedantForm.type" class="w-full px-3 py-1.5 border border-gray-200 rounded focus:border-blue-500 focus:outline-none text-sm">
          @for (t of typesDisponibles; track t.id) {
          <option [value]="t.libelle">{{ t.libelle }}</option>
          }
        </select>
      </div>
    </div>
    <div class="flex justify-end space-x-2 mt-5">
      <button (click)="showCreateModal = false" class="px-3 py-1.5 text-xs font-medium text-gray-600 border border-gray-200 rounded hover:bg-gray-50">Annuler</button>
      <button (click)="createAntecedant()" class="px-3 py-1.5 text-xs font-medium text-white bg-blue-500 rounded hover:bg-blue-600">Créer</button>
    </div>
  </div>
</div>
}

@if (showEditModal) {
<div class="fixed inset-0 bg-black/10 flex items-center justify-center z-50" (click)="showEditModal = false">
  <div class="bg-white rounded p-5 w-[560px] shadow-md" (click)="$event.stopPropagation()">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-lg font-medium text-gray-800">Modifier l’antécédant</h2>
      <button (click)="showEditModal = false" class="text-gray-400 hover:text-gray-600 hover:cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-4">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-xs font-medium text-gray-600 mb-1">ID</label>
        <input type="text" [(ngModel)]="antecedantForm.id" class="w-full px-3 py-1.5 border border-gray-200 rounded focus:border-blue-500 focus:outline-none text-sm" />
      </div>
      <div class="col-span-2">
        <label class="block text-xs font-medium text-gray-600 mb-1">Description</label>
        <textarea [(ngModel)]="antecedantForm.description" rows="3" class="w-full px-3 py-1.5 border border-gray-200 rounded focus:border-blue-500 focus:outline-none text-sm"></textarea>
      </div>
      <div>
        <label class="block text-xs font-medium text-gray-600 mb-1">Type d’antécédant</label>
        <select [(ngModel)]="antecedantForm.type" class="w-full px-3 py-1.5 border border-gray-200 rounded focus:border-blue-500 focus:outline-none text-sm">
          @for (t of typesDisponibles; track t.id) {
          <option [value]="t.libelle">{{ t.libelle }}</option>
          }
        </select>
      </div>
    </div>
    <div class="flex justify-end space-x-2 mt-5">
      <button (click)="showEditModal = false" class="px-3 py-1.5 text-xs font-medium text-gray-600 border border-gray-200 rounded hover:bg-gray-50">Annuler</button>
      <button (click)="updateAntecedant()" class="px-3 py-1.5 text-xs font-medium text-white bg-blue-500 rounded hover:bg-blue-600">Enregistrer</button>
    </div>
  </div>
</div>
}

@if (showDeleteModal) {
<div class="fixed inset-0 bg-black/10 flex items-center justify-center z-50" (click)="showDeleteModal = false">
  <div class="bg-white rounded p-5 w-[560px] shadow-md" (click)="$event.stopPropagation()">
    <div class="flex justify-between items-center mb-3">
      <h2 class="text-lg font-medium text-gray-800">Supprimer l’antécédant</h2>
      <button (click)="showDeleteModal = false" class="text-gray-400 hover:text-gray-600 hover:cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-4">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <p class="text-sm text-gray-500 mb-4">Confirmez la suppression de l’antécédant.</p>
    <div class="flex justify-end space-x-2">
      <button (click)="showDeleteModal = false" class="px-3 py-1.5 text-xs font-medium text-gray-600 border border-gray-200 rounded hover:bg-gray-50">Annuler</button>
      <button (click)="deleteAntecedant()" class="px-3 py-1.5 text-xs font-medium text-white bg-red-500 rounded hover:bg-red-600">Supprimer</button>
    </div>
  </div>
</div>
}